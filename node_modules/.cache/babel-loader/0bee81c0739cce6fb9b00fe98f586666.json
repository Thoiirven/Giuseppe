{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/mnt/c/Users/kikim/OneDrive/Bureau/sentinelle-politique/src/components/BarPourcentage/index.js\";\nimport { json, select } from 'd3';\nimport React, { Component } from 'react';\n\nfunction Presidents(promises) {\n  promises.push(json(\"./data/elections.json\")); // tu push tes données (index 0)\n}\n\n_c = Presidents;\n;\n\nfunction Annee(annee, promises) {\n  promises.push(json(\"../data/\" + annee + \".json\")); // tu push tes données (index 1)\n}\n\n_c2 = Annee;\n;\n\nfunction getElection(annee, elections) {\n  for (let i = 0; i < elections.length; i++) if (annee == elections[i].Annee) return elections[i];\n}\n\n;\n\nfunction getAnnee(annee, pres_prom) {\n  return pres_prom.filter(prom => prom.Annee == annee);\n}\n\nclass BarPourcentage extends Component {\n  constructor(props) {\n    super(props);\n    this.ChoixElection = this.ChoixElection.bind(this);\n  }\n\n  componentDidMount() {\n    this.ChoixElection();\n  }\n\n  componentDidUpdate() {\n    select('#svg-barPourcentage').remove();\n    this.ChoixElection();\n  }\n\n  ChoixElection() {\n    const node = this.node;\n    var promises = []; // Ton tableau de prommesses\n\n    Presidents(promises);\n    Annee(this.props.data, promises);\n    var annee_ = this.props.data; // récupération de la chaine de caractère passée dans le formulaire\n\n    Promise.all(promises).then(function (proms) {\n      var pres_prom = proms[0];\n      var annee_prom = proms[1];\n      var annee = getAnnee(annee_, proms[0]); // DEBUG\n\n      var nbCandidats = annee[0].NbCandidats,\n          totalVotes = 0;\n      var voteCand = [nbCandidats],\n          vote = [nbCandidats],\n          nom = [nbCandidats],\n          pres = [nbCandidats];\n\n      for (let i = 0; i < nbCandidats; i++) {\n        vote[i] = 0;\n        voteCand[i] = 0;\n      }\n\n      nom[0] = annee[0].Candidat1.Prenom + \" \" + annee[0].Candidat1.Nom + \" (\" + annee[0].Candidat1.PartiPol + \")\";\n      nom[1] = annee[0].Candidat2.Prenom + \" \" + annee[0].Candidat2.Nom + \" (\" + annee[0].Candidat2.PartiPol + \")\";\n      annee_prom.forEach(block => {\n        for (let i = 0; i < nbCandidats; i++) vote[i] += block[nom[i]];\n\n        totalVotes += block[\"Exprimés\"];\n      });\n\n      for (let i = 0; i < nbCandidats; i++) {\n        voteCand[i] = vote[i] / totalVotes * 100; // pres[i] = Math.round(voteCand[i] * 10) / 10\n      }\n\n      var w = 80,\n          h = 22,\n          x = (100 - w) / 2,\n          y = 65,\n          z = 100 - x - 6,\n          pres1 = Math.round(voteCand[0] * 10) / 10,\n          pres2 = Math.round(voteCand[1] * 10) / 10,\n          color3 = \"#999999\",\n          color4 = \"#FFFFFF\",\n          ppres1 = pres1 * w / 100;\n      var data = [{\n        pres1,\n        pres2\n      }];\n      var svg = select(node).append('svg').attr('id', 'svg-barPourcentage').attr(\"viewBox\", \"0 0 1300 130\").attr(\"height\", \"10%\").attr(\"width\", \"auto\").classed(\"svg-content-responsive\", true); //class to make it responsive\n\n      var g = svg.selectAll(\"g\").data(data).enter().append(\"g\");\n      addRect(x, y, w, h, annee[0].Candidat2.CodeCouleur);\n      addRect(x, y, ppres1, h, annee[0].Candidat1.CodeCouleur);\n      addRect(49.85, y - 0.5, 0.25, h + 0.5, color3);\n      addText(x + 6, y - 5, annee[0].Candidat1.Nom, annee[0].Candidat1.CodeCouleur, \"20px\");\n      addText(z - 8, y - 5, annee[0].Candidat2.Nom, annee[0].Candidat2.CodeCouleur, \"20px\");\n      addText(48.2, y - 7, \"To Win\", color3, \"14.5px\");\n      addText(x + 1, y + 16, pres1 + \"%\", color4, \"18px\");\n      addText(z + 1, y + 16, pres2 + \"%\", color4, \"18px\");\n      addImage('../Img/' + annee[0].Candidat1.Nom + '.png', x, y - 55);\n      addImage('../Img/' + annee[0].Candidat2.Nom + '.png', z + 0.5, y - 55);\n\n      function addRect(x, y, width, height, color) {\n        g.append(\"rect\").attr('x', x + \"%\").attr('y', y + \"%\").attr('width', width + \"%\").attr('height', height + \"%\").attr('fill', color);\n      }\n\n      function addText(x, y, txt, color, fontSize) {\n        g.append(\"text\").attr(\"x\", x + \"%\").attr(\"y\", y + \"%\").text(txt).style(\"font\", fontSize + \" ReithSans\").style('fill', color).style(\"font-weight\", \"Bold\");\n      }\n\n      function addImage(link, x, y) {\n        svg.append('image').attr('xlink:href', link).attr('width', 65).attr('height', 65).attr('x', x + \"%\").attr('y', y + \"%\");\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: node => this.node = node\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 16\n    }, this);\n  }\n\n}\n\nexport default BarPourcentage;\n/*\r\n// pres1 = [];\r\n//             pres2 = [];\r\n//             for (let i = 0; i < 4; i++) {\r\n//                 nbVotants = data[i][\"Votants\"] - data[i][\"Blancs et nuls\"]\r\n//                 nom1 = annee[0].PrenomPres1 + \" \" + annee[0].NomPres1 + \" (\" + annee[0].PartiPol1 + \")\";\r\n//                 nom2 = annee[0].PrenomPres2 + \" \" + annee[0].NomPres2 + \" (\" + annee[0].PartiPol2 + \")\";\r\n\r\n//                 pres1[0] = data[i][nom1] / nbVotants * 100\r\n//                 pres2[0] = data[i][nom2] / nbVotants * 100 */\n\nfunction CreateBarPourcentage(pres_prom, annee_prom) {\n  const node = this.node;\n  var w = 80,\n      h = 2.8,\n      x = (100 - w) / 2,\n      y = 9,\n      z = 100 - x - 6,\n      color3 = \"#999999\",\n      color4 = \"#FFFFFF\",\n      pres1 = 48,\n      pres2 = 52,\n      ppres1 = pres1 * w / 100;\n  var data = [{\n    pres1,\n    pres2\n  }];\n  var svg = select(node).append('svg').attr('id', 'svg-barPourcentage').attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 300 300\").classed(\"svg-content-responsive\", true); //class to make it responsive\n\n  var g = svg.selectAll(\"g\").data(data).enter().append(\"g\");\n  addRect(x, y, w, h, pres2[2]);\n  addRect(x, y, ppres1, h, pres1[2]);\n  addRect(49.85, y - 0.5, 0.25, h + 0.5, color3);\n  addText(x + 7.5, y - 1, pres1[1], pres1[2], \"6.5px\");\n  addText(z - 12, y - 1, pres2[1], pres2[2], \"6.5px\");\n  addText(47.7, y - 1, \"To Win\", color3, \"4.5px\");\n  addText(x + 1, y + 2.2, pres1 + \"%\", color4, \"6.5px\");\n  addText(z - 0.5, y + 2.2, pres2 + \"%\", color4, \"6.5px\");\n  addImage('../Img/' + pres1[1] + '.png', x, y - 7);\n  addImage('../Img/' + pres2[1] + '.png', z - 0.5, y - 7);\n\n  function addRect(x, y, width, height, color) {\n    g.append(\"rect\").attr('x', x + \"%\").attr('y', y + \"%\").attr('width', width + \"%\").attr('height', height + \"%\").attr('fill', color);\n  }\n\n  ;\n\n  function addText(x, y, txt, color, fontSize) {\n    g.append(\"text\").attr(\"x\", x + \"%\").attr(\"y\", y + \"%\").text(txt).style(\"font\", fontSize + \" ReithSans\").style('fill', color).style(\"font-weight\", \"Bold\");\n  }\n\n  ;\n\n  function addImage(link, x, y) {\n    svg.append('image').attr('xlink:href', link).attr('width', 19).attr('height', 19).attr('x', x + \"%\").attr('y', y + \"%\");\n  }\n\n  ;\n}\n\n_c3 = CreateBarPourcentage;\n;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Presidents\");\n$RefreshReg$(_c2, \"Annee\");\n$RefreshReg$(_c3, \"CreateBarPourcentage\");","map":{"version":3,"sources":["/mnt/c/Users/kikim/OneDrive/Bureau/sentinelle-politique/src/components/BarPourcentage/index.js"],"names":["json","select","React","Component","Presidents","promises","push","Annee","annee","getElection","elections","i","length","getAnnee","pres_prom","filter","prom","BarPourcentage","constructor","props","ChoixElection","bind","componentDidMount","componentDidUpdate","remove","node","data","annee_","Promise","all","then","proms","annee_prom","nbCandidats","NbCandidats","totalVotes","voteCand","vote","nom","pres","Candidat1","Prenom","Nom","PartiPol","Candidat2","forEach","block","w","h","x","y","z","pres1","Math","round","pres2","color3","color4","ppres1","svg","append","attr","classed","g","selectAll","enter","addRect","CodeCouleur","addText","addImage","width","height","color","txt","fontSize","text","style","link","render","CreateBarPourcentage"],"mappings":"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","sourcesContent":["import { json, select } from 'd3';\r\nimport React, { Component } from 'react';\r\n\r\nfunction Presidents(promises) {\r\n    promises.push(json(\"./data/elections.json\")); // tu push tes données (index 0)\r\n};\r\n\r\nfunction Annee(annee, promises) {\r\n    promises.push(json(\"../data/\" + annee + \".json\")); // tu push tes données (index 1)\r\n};\r\n\r\nfunction getElection(annee, elections) {\r\n    for (let i = 0; i < elections.length; i++)\r\n        if (annee == elections[i].Annee)\r\n            return elections[i];\r\n};\r\n\r\nfunction getAnnee(annee, pres_prom) {\r\n    return pres_prom.filter(prom => prom.Annee == annee);\r\n}\r\n\r\n\r\nclass BarPourcentage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.ChoixElection = this.ChoixElection.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.ChoixElection();\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        select('#svg-barPourcentage').remove();\r\n        this.ChoixElection();\r\n    }\r\n\r\n    ChoixElection() {\r\n        const node = this.node;\r\n\r\n        var promises = []; // Ton tableau de prommesses\r\n\r\n        Presidents(promises);\r\n        Annee(this.props.data, promises);\r\n\r\n        var annee_ = this.props.data; // récupération de la chaine de caractère passée dans le formulaire\r\n\r\n        Promise.all(promises).then(function (proms) {\r\n            var pres_prom = proms[0];\r\n            var annee_prom = proms[1];\r\n\r\n            var annee = getAnnee(annee_, proms[0]); // DEBUG\r\n\r\n            var nbCandidats = annee[0].NbCandidats,\r\n                totalVotes = 0;\r\n\r\n            var voteCand = [nbCandidats],\r\n                vote = [nbCandidats],\r\n                nom = [nbCandidats],\r\n                pres = [nbCandidats];\r\n\r\n            for (let i = 0; i < nbCandidats; i++) {\r\n                vote[i] = 0\r\n                voteCand[i] = 0;\r\n            }\r\n\r\n            nom[0] = annee[0].Candidat1.Prenom + \" \" + annee[0].Candidat1.Nom + \" (\" + annee[0].Candidat1.PartiPol + \")\";\r\n            nom[1] = annee[0].Candidat2.Prenom + \" \" + annee[0].Candidat2.Nom + \" (\" + annee[0].Candidat2.PartiPol + \")\";\r\n\r\n            annee_prom.forEach(block => {\r\n\r\n                for (let i = 0; i < nbCandidats; i++)\r\n                    vote[i] += block[nom[i]]\r\n\r\n                totalVotes += block[\"Exprimés\"]\r\n            })\r\n\r\n            for (let i = 0; i < nbCandidats; i++) {\r\n                voteCand[i] = vote[i] / totalVotes * 100\r\n                // pres[i] = Math.round(voteCand[i] * 10) / 10\r\n            }\r\n\r\n            var w = 80,\r\n                h = 22,\r\n                x = (100 - w) / 2,\r\n                y = 65,\r\n                z = 100 - x - 6,\r\n                pres1 = Math.round(voteCand[0] * 10) / 10,\r\n                pres2 = Math.round(voteCand[1] * 10) / 10,\r\n                color3 = \"#999999\",\r\n                color4 = \"#FFFFFF\",\r\n                ppres1 = (pres1 * w) / 100;\r\n\r\n\r\n            var data = [{\r\n                pres1,\r\n                pres2\r\n            }];\r\n\r\n            var svg = select(node)\r\n                .append('svg')\r\n                .attr('id', 'svg-barPourcentage')\r\n                .attr(\"viewBox\", \"0 0 1300 130\")\r\n                .attr(\"height\", \"10%\")\r\n                .attr(\"width\", \"auto\")\r\n                .classed(\"svg-content-responsive\", true);         //class to make it responsive\r\n\r\n            var g = svg.selectAll(\"g\")\r\n                .data(data)\r\n                .enter()\r\n                .append(\"g\");\r\n\r\n            addRect(x, y, w, h, annee[0].Candidat2.CodeCouleur)\r\n            addRect(x, y, ppres1, h, annee[0].Candidat1.CodeCouleur)\r\n            addRect(49.85, y - 0.5, 0.25, h + 0.5, color3)\r\n\r\n            addText(x + 6, y - 5, annee[0].Candidat1.Nom, annee[0].Candidat1.CodeCouleur, \"20px\")\r\n            addText(z - 8, y - 5, annee[0].Candidat2.Nom, annee[0].Candidat2.CodeCouleur, \"20px\")\r\n            addText(48.2, y - 7, \"To Win\", color3, \"14.5px\")\r\n            addText(x + 1, y + 16, pres1 + \"%\", color4, \"18px\")\r\n            addText(z + 1, y + 16, pres2 + \"%\", color4, \"18px\")\r\n\r\n            addImage('../Img/' + annee[0].Candidat1.Nom + '.png', x, y - 55)\r\n            addImage('../Img/' + annee[0].Candidat2.Nom + '.png', z + 0.5, y - 55)\r\n\r\n            function addRect(x, y, width, height, color) {\r\n                g.append(\"rect\")\r\n                    .attr('x', x + \"%\")\r\n                    .attr('y', y + \"%\")\r\n                    .attr('width', width + \"%\")\r\n                    .attr('height', height + \"%\")\r\n                    .attr('fill', color);\r\n            }\r\n\r\n            function addText(x, y, txt, color, fontSize) {\r\n                g.append(\"text\")\r\n                    .attr(\"x\", x + \"%\")\r\n                    .attr(\"y\", y + \"%\")\r\n                    .text(txt)\r\n                    .style(\"font\", fontSize + \" ReithSans\")\r\n                    .style('fill', color)\r\n                    .style(\"font-weight\", \"Bold\");\r\n            }\r\n\r\n            function addImage(link, x, y) {\r\n                svg.append('image')\r\n                    .attr('xlink:href', link)\r\n                    .attr('width', 65)\r\n                    .attr('height', 65)\r\n                    .attr('x', x + \"%\")\r\n                    .attr('y', y + \"%\");\r\n            }\r\n        });\r\n    };\r\n\r\n    render() {\r\n        return <div ref={node => this.node = node} />\r\n    }\r\n}\r\nexport default BarPourcentage;\r\n\r\n/*\r\n// pres1 = [];\r\n//             pres2 = [];\r\n//             for (let i = 0; i < 4; i++) {\r\n//                 nbVotants = data[i][\"Votants\"] - data[i][\"Blancs et nuls\"]\r\n//                 nom1 = annee[0].PrenomPres1 + \" \" + annee[0].NomPres1 + \" (\" + annee[0].PartiPol1 + \")\";\r\n//                 nom2 = annee[0].PrenomPres2 + \" \" + annee[0].NomPres2 + \" (\" + annee[0].PartiPol2 + \")\";\r\n\r\n//                 pres1[0] = data[i][nom1] / nbVotants * 100\r\n//                 pres2[0] = data[i][nom2] / nbVotants * 100 */\r\n\r\nfunction CreateBarPourcentage(pres_prom, annee_prom) {\r\n    const node = this.node;\r\n\r\n    var w = 80,\r\n        h = 2.8,\r\n        x = (100 - w) / 2,\r\n        y = 9,\r\n        z = 100 - x - 6,\r\n        color3 = \"#999999\",\r\n        color4 = \"#FFFFFF\",\r\n        pres1 = 48,\r\n        pres2 = 52,\r\n        ppres1 = (pres1 * w) / 100;\r\n\r\n\r\n    var data = [{\r\n        pres1,\r\n        pres2\r\n    }];\r\n\r\n    var svg = select(node)\r\n        .append('svg')\r\n        .attr('id', 'svg-barPourcentage')\r\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\r\n        .attr(\"viewBox\", \"0 0 300 300\")\r\n        .classed(\"svg-content-responsive\", true);         //class to make it responsive\r\n\r\n    var g = svg.selectAll(\"g\")\r\n        .data(data)\r\n        .enter()\r\n        .append(\"g\");\r\n\r\n    addRect(x, y, w, h, pres2[2])\r\n    addRect(x, y, ppres1, h, pres1[2])\r\n    addRect(49.85, y - 0.5, 0.25, h + 0.5, color3)\r\n\r\n    addText(x + 7.5, y - 1, pres1[1], pres1[2], \"6.5px\")\r\n    addText(z - 12, y - 1, pres2[1], pres2[2], \"6.5px\")\r\n    addText(47.7, y - 1, \"To Win\", color3, \"4.5px\")\r\n    addText(x + 1, y + 2.2, pres1 + \"%\", color4, \"6.5px\")\r\n    addText(z - 0.5, y + 2.2, pres2 + \"%\", color4, \"6.5px\")\r\n\r\n    addImage('../Img/' + pres1[1] + '.png', x, y - 7)\r\n    addImage('../Img/' + pres2[1] + '.png', z - 0.5, y - 7)\r\n\r\n    function addRect(x, y, width, height, color) {\r\n        g.append(\"rect\")\r\n            .attr('x', x + \"%\")\r\n            .attr('y', y + \"%\")\r\n            .attr('width', width + \"%\")\r\n            .attr('height', height + \"%\")\r\n            .attr('fill', color);\r\n    };\r\n\r\n    function addText(x, y, txt, color, fontSize) {\r\n        g.append(\"text\")\r\n            .attr(\"x\", x + \"%\")\r\n            .attr(\"y\", y + \"%\")\r\n            .text(txt)\r\n            .style(\"font\", fontSize + \" ReithSans\")\r\n            .style('fill', color)\r\n            .style(\"font-weight\", \"Bold\");\r\n    };\r\n\r\n    function addImage(link, x, y) {\r\n        svg.append('image')\r\n            .attr('xlink:href', link)\r\n            .attr('width', 19)\r\n            .attr('height', 19)\r\n            .attr('x', x + \"%\")\r\n            .attr('y', y + \"%\");\r\n    };\r\n};"]},"metadata":{},"sourceType":"module"}